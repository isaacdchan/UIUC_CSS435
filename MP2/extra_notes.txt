e.g. to bring the link between nodes 1 and 2 up: 
sudo iptables -I OUTPUT -s 10.1.1.1 -d 10.1.1.2 -j ACCEPT ; sudo iptables -I OUTPUT -s 10.1.1.2 -d 10.1.1.1 -j ACCEPT

To take that link down:
sudo iptables -D OUTPUT -s 10.1.1.1 -d 10.1.1.2 -j ACCEPT ; sudo iptables -D OUTPUT -s 10.1.1.2 -d 10.1.1.1 -j ACCEPT

log file format:
sprintf(logLine, "sending packet dest %d nexthop %d message %s\n", dest, nexthop, message);
sprintf(logLine, "forward packet dest %d nexthop %d message %s\n", dest, nexthop, message);
sprintf(logLine, "receive packet message %s\n", message);
sprintf(logLine, "unreachable dest %d\n", dest);

... and then fwrite(logLine, 1, strlen(logLine), theLogFile);

If that's all you do to the log file, you will have the correct format. (Don't worry about closing it; 
when your process gets killed, any output should be flushed + the file will be closed).

